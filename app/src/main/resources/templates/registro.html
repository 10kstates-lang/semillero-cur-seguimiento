<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Registro - Semilleros CUR</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; }
        .registro-container { max-width: 500px; margin-top: 50px; }
    </style>
</head>
<body>

<div class="container registro-container">
    <div class="card shadow">
        <div class="card-header bg-primary text-white text-center">
            <h3>Registro de Estudiante</h3>
        </div>
        <div class="card-body p-4">
            <form id="registroForm">
                <div class="mb-3">
                    <label class="form-label">Nombre Completo</label>
                    <input type="text" id="nombre" class="form-control" placeholder="Ej: Juan Pérez" required>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Correo Institucional</label>
                    <input type="email" id="correo" class="form-control" placeholder="usuario@cur.edu.co" required>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Contraseña</label>
                    <input type="password" id="password" class="form-control" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Facultad / Carrera</label>
                    <select id="facultad" class="form-select">
                        <option value="INGENIERIA">Ingeniería de Sistemas</option>
                        <option value="CONTADURIA">Contaduría</option>
                    </select>
                </div>

                <button type="submit" class="btn btn-primary w-100">Crear Cuenta</button>
            </form>
            <div class="mt-3 text-center">
                <a href="/login">¿Ya tienes cuenta? Inicia sesión</a>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('registroForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const datos = {
            nombre: document.getElementById('nombre').value,
            correo: document.getElementById('correo').value,
            password: document.getElementById('password').value,
            facultad: document.getElementById('facultad').value
        };

        try {
            const response = await fetch('/api/usuarios/registro', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(datos)
            });

            if (response.ok) {
                alert("¡Registro exitoso! Ahora puedes iniciar sesión.");
                window.location.href = "/login";
            } else {
                alert("Error al registrar: El correo podría estar ya en uso.");
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Error de conexión con el servidor.");
        }
    });
</script>

</body>
</html>